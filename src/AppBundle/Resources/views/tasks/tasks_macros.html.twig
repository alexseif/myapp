{% macro taskIcons(urgency = 0, priority = 0) %}
  {% if urgency %}
    <span class="badge badge-warning">U</span>
  {% endif %}
  {% if priority > 0 %}
    <span class="badge badge-danger">H</span>
  {% elseif priority < 0 %}
    <span class="badge badge-secondary">L</span>
  {% endif %}
{% endmacro %}

{% macro li(task, displayListName = true) %}
  {% import _self as taskUI %}
  <li class="list-group-item {{ task.completed ? "completed" }}" 
      data-order="id_{{task.id}}" 
      id="task_{{task.id}}" 
      data-id="{{task.id}}"
      data-time="{{ task.est }}"
      data-order-no="{{ task.order }}"
      >
    <label class="btn btn-secondary btn-{{ task.completed ? "xs":"sm" }} task">
      <input type="checkbox" data-taskid="{{task.id}}" class="checkbox-inline" 
             {{ task.completed ? "checked" : "" }}/>
      {{ task.task|truncate(50) }}
      <span class="ml-1">
        {{ taskUI.taskIcons(task.urgency, task.priority) }}
      </span>
    </label>
    <a
      class="btn-sm"
      data-toggle="modal"
      data-target="#"
      href="{{ path('task_show_modal', {"id":task.id}) }}"
      >Open</a>

    {% if displayListName %}
      <span class="visible-lg-inline-block visible-md-inline-block">
        <a class="badge badge-default task-list-name" 
           data-tasklist="{{ task.taskList.name }}" 
           href="{{ path("focus_tasklist", {'name':task.taskList.name}) }}">{{ task.taskList.name }}</a>
        {% if (task.taskList.account) %}
          <a href="{{ path('accounts_show', {'id': task.taskList.account.id}) }}"
             class="badge badge-info">{{ task.taskList.account.name }}</a>
          {% if (task.taskList.account.client) %}
            <a href="{{ path('client_show', {'id': task.taskList.account.client.id}) }}"
               class="badge badge-primary">{{ task.taskList.account.client.name }}</a>
          {% endif %}
        {% endif %}
      </span>
    {% endif %}
    <small class="text-info">{{ task.est ? task.est ~ "m"}}</small>
    <span class="visible-lg-inline visible-md-inline">
      {% if(not task.completed) %}
        <a  data-taskid="{{task.id}}"
            data-postpone="+1 hour"
            title="5 mins"
            class="btn btn-secondary edit-fixed-link postpone btn-sm"
            style="right: 95px;">
          <img src="/images/snooze_white_18x18.png" width="18px" />
        </a>
        <a  data-taskid="{{task.id}}"
            data-postpone="tomorrow"
            title="tomorrow"
            class="btn btn-secondary edit-fixed-link postpone btn-sm"
            style="right: 50px;">
          <img src="/images/zzz.png" width="18px"/>
        </a>

      {% endif %}

      <a href="{{ path('tasks_edit', { 'id': task.id }) }}" 
         class="btn btn-secondary edit-fixed-link btn-{{ task.completed ? "xs":"sm" }}">
        Edit</a>
    </span>
  </li>
{% endmacro %}

{% macro ul(tasks, id, displayListName = true) %}
  {% import _self as taskUI %}

  <ul class="list-group task-list" {{ (id) ? 'id='~id }}>
    {% for task in tasks %}
      {{ taskUI.li(task, displayListName) }}
    {% endfor %}
  </ul>   
{% endmacro %}